***************
*** 141,147 ****
   * even on CONFIG_PREEMPT, because lockdep assumes that interrupts are
   * not re-enabled during lock-acquire (which the preempt-spin-ops do):
   */
- #if !defined(CONFIG_GENERIC_LOCKBREAK) || defined(CONFIG_DEBUG_LOCK_ALLOC)
  
  static inline void __raw_read_lock(rwlock_t *lock)
  {
--- 141,149 ----
   * even on CONFIG_PREEMPT, because lockdep assumes that interrupts are
   * not re-enabled during lock-acquire (which the preempt-spin-ops do):
   */
+ #if !defined(CONFIG_GENERIC_LOCKBREAK) ||	\
+ 	defined(CONFIG_DEBUG_LOCK_ALLOC) ||	\
+ 	defined(CONFIG_IPIPE)
  
  static inline void __raw_read_lock(rwlock_t *lock)
  {
