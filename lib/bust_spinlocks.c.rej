***************
*** 13,18 ****
  #include <linux/wait.h>
  #include <linux/vt_kern.h>
  #include <linux/console.h>
  
  
  void __attribute__((weak)) bust_spinlocks(int yes)
--- 13,19 ----
  #include <linux/wait.h>
  #include <linux/vt_kern.h>
  #include <linux/console.h>
+ #include <linux/ipipe_trace.h>
  
  
  void __attribute__((weak)) bust_spinlocks(int yes)
***************
*** 24,29 ****
  		unblank_screen();
  #endif
  		console_unblank();
  		if (--oops_in_progress == 0)
  			wake_up_klogd();
  	}
--- 25,31 ----
  		unblank_screen();
  #endif
  		console_unblank();
+   		ipipe_trace_panic_dump();
  		if (--oops_in_progress == 0)
  			wake_up_klogd();
  	}
