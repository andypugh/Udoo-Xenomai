***************
*** 765,772 ****
  #endif
  	extern char __stubs_start[], __stubs_end[];
  	extern char __vectors_start[], __vectors_end[];
  	extern char __kuser_helper_start[], __kuser_helper_end[];
  	int kuser_sz = __kuser_helper_end - __kuser_helper_start;
  
  	/*
  	 * Copy the vectors, stubs and kuser helpers (in entry-armv.S)
--- 765,777 ----
  #endif
  	extern char __stubs_start[], __stubs_end[];
  	extern char __vectors_start[], __vectors_end[];
+ #ifndef CONFIG_IPIPE
  	extern char __kuser_helper_start[], __kuser_helper_end[];
  	int kuser_sz = __kuser_helper_end - __kuser_helper_start;
+ #else /* !CONFIG_IPIPE */
+ 	extern char __ipipe_tsc_area_start[], __kuser_helper_end[];
+ 	int kuser_sz = __kuser_helper_end - __ipipe_tsc_area_start;
+ #endif /* !CONFIG_IPIPE */
  
  	/*
  	 * Copy the vectors, stubs and kuser helpers (in entry-armv.S)
***************
*** 775,781 ****
  	 */
  	memcpy((void *)vectors, __vectors_start, __vectors_end - __vectors_start);
  	memcpy((void *)vectors + 0x200, __stubs_start, __stubs_end - __stubs_start);
  	memcpy((void *)vectors + 0x1000 - kuser_sz, __kuser_helper_start, kuser_sz);
  
  	/*
  	 * Do processor specific fixups for the kuser helpers
--- 780,791 ----
  	 */
  	memcpy((void *)vectors, __vectors_start, __vectors_end - __vectors_start);
  	memcpy((void *)vectors + 0x200, __stubs_start, __stubs_end - __stubs_start);
+ #ifndef CONFIG_IPIPE
  	memcpy((void *)vectors + 0x1000 - kuser_sz, __kuser_helper_start, kuser_sz);
+ #else /* !CONFIG_IPIPE */
+ 	BUG_ON(0x1000 - kuser_sz < 0x200 + __stubs_end - __stubs_start);
+ 	memcpy((void *)vectors + 0x1000 - kuser_sz, __ipipe_tsc_area_start, kuser_sz);
+ #endif /* !CONFIG_IPIPE */
  
  	/*
  	 * Do processor specific fixups for the kuser helpers
