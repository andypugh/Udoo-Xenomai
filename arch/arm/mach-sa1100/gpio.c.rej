***************
*** 32,40 ****
  {
  	unsigned long flags;
  
- 	local_irq_save(flags);
  	GPDR &= ~GPIO_GPIO(offset);
- 	local_irq_restore(flags);
  	return 0;
  }
  
--- 32,40 ----
  {
  	unsigned long flags;
  
+ 	local_irq_save_hw(flags);
  	GPDR &= ~GPIO_GPIO(offset);
+ 	local_irq_restore_hw(flags);
  	return 0;
  }
  
***************
*** 42,51 ****
  {
  	unsigned long flags;
  
- 	local_irq_save(flags);
  	sa1100_gpio_set(chip, offset, value);
  	GPDR |= GPIO_GPIO(offset);
- 	local_irq_restore(flags);
  	return 0;
  }
  
--- 42,51 ----
  {
  	unsigned long flags;
  
+ 	local_irq_save_hw(flags);
  	sa1100_gpio_set(chip, offset, value);
  	GPDR |= GPIO_GPIO(offset);
+ 	local_irq_restore_hw(flags);
  	return 0;
  }
  
