***************
*** 22,27 ****
  #include <linux/err.h>
  #include <linux/platform_device.h>
  #include <mach/common.h>
  
  int __init mxc_register_device(struct platform_device *pdev, void *data)
  {
--- 22,28 ----
  #include <linux/err.h>
  #include <linux/platform_device.h>
  #include <mach/common.h>
+ #include <mach/hardware.h>
  
  int __init mxc_register_device(struct platform_device *pdev, void *data)
  {
***************
*** 89,91 ****
  
  	return pdev;
  }
--- 90,113 ----
  
  	return pdev;
  }
+ 
+ static int post_cpu_init(void)
+ {
+ #ifdef CONFIG_MACH_MX27
+ 	if (cpu_is_mx27())
+ 		ipipe_mach_allow_hwtimer_uaccess(MX27_IO_P2V(MX27_AIPI_BASE_ADDR), 3);
+ #endif /* CONFIG_MACH_MX27 */
+ #ifdef CONFIG_MACH_MX25
+ 	if (cpu_is_mx25())
+ 		ipipe_mach_allow_hwtimer_uaccess(MX25_AIPS1_BASE_ADDR_VIRT,
+ 						 MX25_AIPS2_BASE_ADDR_VIRT);
+ #endif /* CONFIG_MACH_MX25 */
+ #ifdef CONFIG_MACH_MX31
+ 	if (cpu_is_mx31())
+ 		ipipe_mach_allow_hwtimer_uaccess(AIPS1_BASE_ADDR_VIRT,
+ 						 AIPS2_BASE_ADDR_VIRT);
+ #endif /* CONFIG_MACH_MX31 */
+ 	return 0;
+ }
+ 
+ postcore_initcall(post_cpu_init);
