***************
*** 34,39 ****
  		.pfn		= __phys_to_pfn(AT91RM9200_BASE_EMAC),
  		.length		= SZ_16K,
  		.type		= MT_DEVICE,
  	}, {
  		.virtual	= AT91_IO_VIRT_BASE - AT91RM9200_SRAM_SIZE,
  		.pfn		= __phys_to_pfn(AT91RM9200_SRAM_BASE),
--- 34,46 ----
  		.pfn		= __phys_to_pfn(AT91RM9200_BASE_EMAC),
  		.length		= SZ_16K,
  		.type		= MT_DEVICE,
+ #ifdef CONFIG_IPIPE
+ 	}, {
+ 		.virtual	= AT91_VA_BASE_TCB0,
+ 		.pfn		= __phys_to_pfn(AT91_BASE_TCB0),
+ 		.length		= SZ_16K,
+ 		.type		= MT_DEVICE,
+ #endif /* CONFIG_IPIPE */
  	}, {
  		.virtual	= AT91_IO_VIRT_BASE - AT91RM9200_SRAM_SIZE,
  		.pfn		= __phys_to_pfn(AT91RM9200_SRAM_BASE),
***************
*** 349,354 ****
   * The default interrupt priority levels (0 = lowest, 7 = highest).
   */
  static unsigned int at91rm9200_default_irq_priority[NR_AIC_IRQS] __initdata = {
  	7,	/* Advanced Interrupt Controller (FIQ) */
  	7,	/* System Peripherals */
  	1,	/* Parallel IO Controller A */
--- 356,362 ----
   * The default interrupt priority levels (0 = lowest, 7 = highest).
   */
  static unsigned int at91rm9200_default_irq_priority[NR_AIC_IRQS] __initdata = {
+ #ifndef CONFIG_IPIPE
  	7,	/* Advanced Interrupt Controller (FIQ) */
  	7,	/* System Peripherals */
  	1,	/* Parallel IO Controller A */
***************
*** 381,386 ****
  	0,	/* Advanced Interrupt Controller (IRQ4) */
  	0,	/* Advanced Interrupt Controller (IRQ5) */
  	0	/* Advanced Interrupt Controller (IRQ6) */
  };
  
  void __init at91rm9200_init_interrupts(unsigned int priority[NR_AIC_IRQS])
--- 389,430 ----
  	0,	/* Advanced Interrupt Controller (IRQ4) */
  	0,	/* Advanced Interrupt Controller (IRQ5) */
  	0	/* Advanced Interrupt Controller (IRQ6) */
+ #else /* CONFIG_IPIPE */
+ /* Give the highest priority to TC, since they are used as timer interrupt by
+    I-pipe. */
+ 	7,	/* Advanced Interrupt Controller */
+ 	6,	/* System Peripheral */
+ 	0,	/* Parallel IO Controller A */
+ 	0,	/* Parallel IO Controller B */
+ 	0,	/* Parallel IO Controller C */
+ 	0,	/* Parallel IO Controller D */
+ 	5,	/* USART 0 */
+ 	5,	/* USART 1 */
+ 	5,	/* USART 2 */
+ 	5,	/* USART 3 */
+ 	0,	/* Multimedia Card Interface */
+ 	3,	/* USB Device Port */
+ 	0,	/* Two-Wire Interface */
+ 	5,	/* Serial Peripheral Interface */
+ 	4,	/* Serial Synchronous Controller */
+ 	4,	/* Serial Synchronous Controller */
+ 	4,	/* Serial Synchronous Controller */
+ 	7,	/* Timer Counter 0 */
+ 	7,	/* Timer Counter 1 */
+ 	7,	/* Timer Counter 2 */
+ 	0,	/* Timer Counter 3 */
+ 	0,	/* Timer Counter 4 */
+ 	0,	/* Timer Counter 5 */
+ 	2,	/* USB Host port */
+ 	2,	/* Ethernet MAC */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0,	/* Advanced Interrupt Controller */
+ 	0	/* Advanced Interrupt Controller */
+ #endif /*CONFIG_IPIPE */
  };
  
  void __init at91rm9200_init_interrupts(unsigned int priority[NR_AIC_IRQS])
