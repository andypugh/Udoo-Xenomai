***************
*** 6,13 ****
  typedef struct {
  #ifdef CONFIG_CPU_HAS_ASID
  	unsigned int id;
- 	spinlock_t id_lock;
  #endif
  	unsigned int kvm_seq;
  } mm_context_t;
  
--- 6,25 ----
  typedef struct {
  #ifdef CONFIG_CPU_HAS_ASID
  	unsigned int id;
+ 	ipipe_spinlock_t id_lock;
  #endif
+ #ifdef CONFIG_ARM_FCSE
+ 	struct {
+ 		unsigned long pid;
+ #ifdef CONFIG_ARM_FCSE_BEST_EFFORT
+ 		unsigned shared_dirty_pages;
+ 		unsigned active : 1;
+ 		unsigned large : 1;
+ 		unsigned high_pages;
+ 		unsigned long highest_pid;
+ #endif /* CONFIG_ARM_FCSE_BEST_EFFORT */
+ 	} fcse;
+ #endif /* CONFIG_ARM_FCSE */
  	unsigned int kvm_seq;
  } mm_context_t;
  
***************
*** 15,22 ****
  #define ASID(mm)	((mm)->context.id & 255)
  
  /* init_mm.context.id_lock should be initialized. */
- #define INIT_MM_CONTEXT(name)                                                 \
- 	.context.id_lock    = __SPIN_LOCK_UNLOCKED(name.context.id_lock),
  #else
  #define ASID(mm)	(0)
  #endif
--- 27,34 ----
  #define ASID(mm)	((mm)->context.id & 255)
  
  /* init_mm.context.id_lock should be initialized. */
+ #define INIT_MM_CONTEXT(name)				\
+ 	.context.id_lock    = IPIPE_SPIN_LOCK_UNLOCKED,
  #else
  #define ASID(mm)	(0)
  #endif
