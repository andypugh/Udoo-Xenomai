***************
*** 72,78 ****
  		write_sequnlock(&xtime_lock);
  	}
  
- 	update_process_times(user_mode(get_irq_regs()));
  	profile_tick(CPU_PROFILING);
  }
  
--- 72,78 ----
  		write_sequnlock(&xtime_lock);
  	}
  
+ 	update_root_process_times(get_irq_regs());
  	profile_tick(CPU_PROFILING);
  }
  
***************
*** 180,185 ****
  
  	td->evtdev = newdev;
  
  	/*
  	 * When the device is not per cpu, pin the interrupt to the
  	 * current cpu:
--- 180,189 ----
  
  	td->evtdev = newdev;
  
+ 	/* I-pipe: derive global tick IRQ from CPU 0 */
+ 	if (cpu == 0)
+ 		ipipe_update_tick_evtdev(newdev);
+ 
  	/*
  	 * When the device is not per cpu, pin the interrupt to the
  	 * current cpu:
